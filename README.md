# Краткие заметки о машинном обучении

Задача данного репозитария - подготовить заметки, помогающие решать тестовые задачи на курсах обучения машинному обучению. В качестве языка программирования планируется использовать Python.

Основной инструмент работы - [Google Colab](https://colab.research.google.com/#), одно из ключевых преимуществ которого состоит в том, что он позволяет в удобном форме обмениваться "блокнотами" (.ipynb) - документами, которые совмещают в себе текстовые комментарии, формулы и код на Python, что делает его очень удобным при обмене данными между преподавателем и студентами. Также Colab позволяет избежать сложной настройки среды исполнения, автоматически доустанавливая необходимые для работы пакеты (packages).

У Google Colab отличная интеграция с Google Drive, которая позволяет сохранять .ipynb-файлы на Drive, и использовать Drive для запуска виртуальной машины Google Colab.

## Получение данных в виртуальной машине Colab

Одним из популярных источников данных для изучения ML является репозитарий **Kaggle Datasets**.

В случае использования Google Colab загружать данные можно следующим кодом:

```py
import pandas as pd

# Загружаем данные в Pandas DataFrame
df = pd.read_csv('your_file.csv')
print(df.head())
```

Однако, если потребуется загружать данные из Kaggle на локальную машину, то может потребоваться получить ключ API, загружать и распаковывать архив.

Загрузить данные в Colab с локального диска можно следующим образом:

```py
from google.colab import files

# Загрузка файла
uploaded = files.upload()

# Выводим названия загруженных файлов
for filename in uploaded.keys():
    print(f'Файл загружен: {filename}')
```

Если необходимо сохранить файл под конкретным именем, то его может потребоваться переименовать.

Указать кодировку (encoding) данных можно используя дополнительный параметр:

```py
df = pd.read_csv('имя_вашего_файла.csv', encoding='utf-8') 
```

Также можно указать символ-разделитель при разборе CSV-файла:

```py
df = pd.read_csv('имя_вашего_файла.csv', sep=';')
```

Также можно подключить достут к Google Drive из виртуальной машины Colab:

```py
from google.colab import drive
import pandas as pd

# Подключение Google Диска
drive.mount('/content/drive')

# Чтение CSV файла с Google Диска
df = pd.read_csv('/content/drive/MyDrive/MyFolder/data.csv')
print(df.head())
```

Однако в этом случае необходимо предоставить права доступа.

## Ключевые библиотеки ML для Python

- numpy - реализация математических функций, таких как: linspace(), sin(), random()
- matplotlib - визуализация данных в виде графиков
- Pandas - импорт данных из разных источников (например, CSV-файлов), формирование выборок данных

## Pandas

Официальная документация библиотеки доступна [здесь](https://pandas.pydata.org/docs/)

Курсы по Pandas на Udemy: [Борис Пасхавер](https://www.udemy.com/user/borispaskhaver/)

Официальный репозиторий на [Github](https://github.com/pandas-dev/pandas)

Установить Pandas можно посредством [репозитария PyPi](https://pepy.tech/projects/pandas)

Уэс Маккини: "Эмперическое правильно для Pandas: оперативной памяти должно быть в 5-10 раз больше, чем объём набора данных".

Конкуренты Pandas: язык R (Хэдли Викхэм) и SAS от SAS Institute.

Для изучения Pandas часто используются блокноты Jupyter. Набор готовых блокнотов от Бориса Пасхавера доступен [здесь](https://github.com/paskhaver/pandas-in-action)

Типовой импорт Pandas:

```py
import pandas as pd
```

Чтения данных из файла:

```py
pd.read_csv("movies.csv")
```

При загрузке данных мы можем указать имя поля, которое является уникальным индексом:


```py
pd.read_csv("movies.csv", index_col="Title")
```

Библиотека Pandas использует два основных типа объектов:

- DataFrame - для хранения наборов данных с несколькими столбцами
- Series - для хранения наборов данных из одного столбца

Извлечь первые несколько строк можно командой: `movies.head(4)`

Извлечь последние несколько строк можно командой: `movies.tail(6)`

Получить информацию о наборе данных в DataFrame: `movies.shape`

Общее количество ячеек: `movies.size`

Запросить типы данных столбцов DataFrame: `movies.dtypes`

Получить одну строку по индексу можно с помощью iloc:

```py
movies.iloc[499]            # По индексу
movies.loc["Forrest Gump"]  # По метке индекса
```

Сортировка по значению:

```py
movies.sort_values(by=["Studio","Year"]).head()
movies.sort_index().head()
```

Часто нам приходится выполнять некоторые действия по одной колонке. Данные из одной колонки называются Series. Получить объект типа Series можно из DataFrame: `movies["Studio"]`. Например, мы можем выбрать колонку и подсчитать количество уникальных значений в ячейках этой серии:

```py
movies["Studio"].value_counts().head(10)
```

Чтобы отобрать из DataFrame данные по конкретной колонке, можно использовать конструкцию:

```py
release_by_universal = (movies["Studio"] == "Universal")
movies[release_by_universal].head()
```

Можно использовать несколько условий:

```py
released_in_2015 = (movies["Year"] == 2015)
movies[release_by_universal & released_in_2015]
```

Мы можем использовать разные логические операторы, в том числе `&` и `|`
